<br>
<div class="row">
  <div class="col text-start">
    <h1 class="pb-3" *ngIf="action === 'consumerDetail' || action === ''" >Vista 360 de {{ consumerDetails.name }}</h1>
    <h1 class="pb-3" *ngIf="action === 'createPQR'">Crear PQR para {{ consumerDetails.name }}</h1>
    </div>
</div>

<div class="row">
  <!-- Left Column: Personal Information -->
  <div class="col-md-6">
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <p class="mb-1 text-muted" i18n>Tipo de identificación</p>
          <p class="fw-bold">{{ consumerDetails.identification_type }}</p>
        </div>
        <div class="mb-3">
          <p class="mb-1 text-muted" i18n>Número de contacto</p>
          <p class="fw-bold">{{ consumerDetails.contact_number }}</p>
        </div>
        <div class="mb-3">
          <p class="mb-1 text-muted" i18n>Dirección</p>
          <p class="fw-bold">{{ consumerDetails.address }}</p>
        </div>
      </div>
      <div class="col-md-6">
        <div class="mb-3">
          <p class="mb-1 text-muted" i18n>Número de identificación</p>
          <p class="fw-bold">{{ consumerDetails.identification_number }}</p>
        </div>
        <div class="mb-3">
          <p class="mb-1 text-muted" i18n>Correo electrónico del Consumidor</p>
          <p class="fw-bold">{{ consumerDetails.email }}</p>
        </div>
      </div>
    </div>


  </div>

  <!-- Right Column: Companies Section -->
  <div class="col-md-6">
    <h4 class="fw-bold mb-3" i18n>Empresas asociadas con el consumidor</h4>

    <!-- Show different content based on the action -->
    <div *ngIf="action === 'createPQR'">
      <!-- Dropdown if there are companies -->
      <div *ngIf="consumerDetails.companies.length > 0; else noCompanies">
        <select class="form-select" [(ngModel)]="selectedCompany">
          <option *ngFor="let company of consumerDetails.companies" [value]="company.id">{{ company.name }}</option>
        </select>
      </div>

      <!-- No companies message -->
      <ng-template #noCompanies>
        <p i18n>El usuario no tiene ninguna empresa asociada y por consiguiente no es posible crear una PQR en este momento. Por favor, asocia al usuario a una empresa primero.</p>
      </ng-template>
    </div>

    <!-- Standard list for consumerDetail action -->
    <ul *ngIf="action === 'consumerDetail'" class="list-group">
      <li *ngFor="let company of consumerDetails.companies" class="list-group-item bg-dark text-white border-0">
        {{ company.name }}
      </li>
    </ul>
  </div>
</div>

<!-- Form for creating PQR (only if action is createPQR) -->
<div *ngIf="action === 'createPQR'">
  <form [formGroup]="pqrForm" (ngSubmit)="submitPQR()">
    <div class="mb-3">
      <label for="subject" class="form-label" i18n>Asunto</label>
      <input type="text" id="subject" class="form-control" formControlName="subject" placeholder="Asunto" />
    </div>

    <div class="mb-3">
      <label for="description" class="form-label" i18n>Descripción</label>
      <textarea id="description" class="form-control" formControlName="description" placeholder="Descripción"></textarea>
    </div>

    <!-- Buttons -->
    <div class="mt-4 d-flex justify-content-center">
      <button type="button" class="btn btn-danger rounded-pill me-2" (click)="goBack()" i18n>Regresar</button>
      <button type="submit" class="btn btn-primary rounded-pill" [disabled]="pqrForm.invalid || !selectedCompany" i18n>Crear PQR</button>
    </div>
  </form>
</div>

<!-- Buttons for consumerDetail -->
<div *ngIf="action === 'consumerDetail'" class="mt-4 d-flex justify-content-center">
  <button class="btn btn-danger rounded-pill me-2" (click)="goBack()" i18n>Regresar</button>
  <button class="btn btn-primary rounded-pill" (click)="goInit()" i18n>Ir al inicio</button>
</div>
